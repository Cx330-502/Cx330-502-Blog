---
title: 组合数学笔记
date: 2023-09-05 11:20:25
updated:
tags: 组合数学 笔记 学习
categories: 笔记
keywords: 组合数学 笔记 学习
description: 对方不想和你说话并向你扔了一本组合数学(bushi) 上学期记了一个学期的组合数学笔记发一下叭~
disableNunjucks: true
top_img:
comments:
cover:
toc:
toc_number:
toc_style_simple:
copyright:
copyright_author:
copyright_author_href:
copyright_url:
copyright_info:
mathjax: true
katex:
aplayer:
highlight_shrink:
aside:
abcjs:
---

### 组合数学

[TOC]

## 第2章 组合与排列

### 2.2 集合的排列

插空法 捆绑法 隔板法

> 循环排列

全排列种类数 `$ =\frac{P(n,n)}{n}=(n-1)! $` 

循环r排列个数 `$ =\frac{P(n,r)}{r}=\frac {n!}{r(n-r)!} $ `

> 项链排列

r排列个数 `$ =\frac{P(n,r)}{2r}=\frac{n!}{2r!(n-r)!} $` 

### 2.3 集合的组合

排列:
$$
C(n,r)=\frac{n!}{r!(n-r)!}
$$
性质1:
$$
C(n,r)=c(n,n-r)
$$

性质2:
$$
k{n\choose k}=n{n-1\choose k-1}
$$

> 帕斯卡公式

$$
C(n,k)=C(n-1,k)+C(n-1,k-1)
$$

$$
C(n,0)+...+C(n,n)=2^n
$$

### 2.4 多重集合的排列

> 概念

多重集：允许元素重复（多重集不是集合）

无限重复排列 有限重复排列

> 定理

1. 无限重复 r排列

**令S是多重集，它有k种不同的元素，每种元素都有无限重复次数，那么，S*的r排列个数为 $ k^r $ **

2. 有限重复 全排列 

**令S是多重集，它有k种不同的元素，
每种元素的重复数分别为 `$ n_1 $` ,  `$ n_2 $` , …, `$ n_k $` ,则S的排列数等于** 
$$
\frac{n!}{n_1!n_2!...n_k!}
$$
**其中n= `$ n_1 $` + `$ n_2 $` + …+ `$ n_k $` ** 

3. 集合划分

**设 `$ n,n_1,n_2,…,n_k $` 是正整数，且 `$ n=n_1+n_2 +…+n_k $` 。将n个元素集合划分成k个标有标签的盒子 `$ B_1,B_2,…,B_k $` ,其中 `$ B_i $` 含有 `$ n_i $` 个元素(i=1, 2,…,k), 则划分方法数为**
$$
\frac{n!}{n_1!n_2!...n_k!}
$$
**若盒子无标号，划分数为**
$$
\frac{n!}{k!n_1!n_2!...n_k!}
$$

4. 非攻击性车

懒得写力~自己想罢

### 2.5 多重集合的组合

<a id="2.5">2.5 多重集合的组合</a>
[去瞅瞅更完整的6.2](#6.2)

> 定义

多重集S的一个r组合是S的子多重集

> 方法

1. 有重组合转无重组合

**{1, 2, …,k}的r组合数={1, 2, …,k+r-1}的无重r组合数= `$ {r+k-1}\choose{r} $` **

2. 隔板法

$$
{{r+k-1}\choose{k-1}}={{r+k-1}\choose{r}}
$$

**相当于r个盒子，插k-1个板，两个板之间放球，但某种球可以不放，因此再加k个盒子，使每种球至少放一个盒子**

> 定理

**令S是多重集，它有k个不同的元素，每个元素都有无限重复次数，那么，S的r组合个数为**
$$
{{r+k-1}\choose{k-1}}={{r+k-1}\choose{r}}
$$


多重集组合->方程的非负整数集

### 2.6 有限概率

> 定义

**有限概率:相对于微积分为基础的连续概率**





### 方法

> 不相邻问题

转换为整数解问题 使用隔板法

#### 方程的解问题

##### 非负整数解

 `$ x_1+x_2+...+x_k=n $`  的非负整数解个数为  `$ {n+k-1\choose n}={n+k-1\choose k-1} $` 

##### 正整数解(万物之源)

 `$ x_1+x_2+...+x_k=n $`  的正整数解个数为  `$ n-1\choose k-1 $` 

#### 不相邻问题

##### 链不相邻问题

转换为方程的解问题

设为  `$ n $`  个球中取  `$ k $`  个不相邻数，可理解为插入  `$ k $`  个挡板，每个挡板的左边球为所取的球

转换为方程为  `$ x_1+x_2+...+x_k+x_{k+1}=n $`  ，其中 
$$
x_1 \geq 1,x_2\geq2,x_3\geq2,...,x_k\geq2,x_{k+1}\geq0
$$
代入正整数解问题，求解得不相邻问题的数量为：
$$
{n-1-(k-1)+1\choose(k+1)-1}={n-k+1\choose k}
$$

##### 环不相邻问题

用链不相邻问题推导
$$
\begin{aligned}
a(n,k)&=2\times{2n-3-(k-1)+1\choose k-1}+
{2n-2-k+1\choose k}\\
&=2\times{2n-k-1\choose k-1}+
{2n-k-1\choose k}\\
&=2\times\frac{(2n-k-1)!}{(k-1)!(2n-2k)!}+\frac{(2n-k-1)!}{k!(2n-2k-1)!}\\
&=2\times\frac{k}{2n-k}\times{2n-k\choose k}+\frac{2n-2k}{2n-k}\times{2n-k\choose k}\\
&=\frac{2n}{2n-k}{2n-k\choose k}
\end{aligned}
$$

## 第3章 鸽巢原理

> 鸽巢原理研究的是存在性问题

核心在于构建出盒子和物体

> 简单形式: n个盒子,n+1个物体
>
> 加强形式: m个盒子,n个物体

知识点:

1. 数论问题
2. 几何图形类问题
3. 连续时间问题
4. 棋盘着色
5. 中国剩余定理
6. 满足条件的最小物体数



### 3.1 鸽巢原理的简单形式

> 定理

1. 鸽巢原理的简单形式

**如果把n＋1个物体放进n个盒子，那么至少有一个盒子包含两个或更多的物体**

2. 中国剩余定理

**设 `$ m_1, m_2,…,m_k $` 是k个两两互素的正整数， `$ 0\leq a_i<m_i(i=1,...,k) $` ,则存在x，使得 x 除以  `$ m_i $` 的余数为  `$ a_i $` ，即 `$ x \equiv ai (\bmod m_i) (i=1,…，k) $` **

$$
\begin{cases}
	\ x \equiv a_1 (\bmod m_1)\\
	\ x \equiv a_2 (\bmod m_2)\\
	\ \ldots\\
	\ x \equiv a_n (\bmod m_n)\\
\end{cases}
$$

### 3.2 鸽巢原理的加强形式

> 定理

1. 鸽巢原理的加强形式

令 `$ q_1, q_2 , …, q_n $` 为正整数。如果将 `$ q_1+q_2+…+q_n – n+1 $` 个物体被放进n个盒子内，那么，
	或者第1个盒子至少含有 `$ q_1 $` 个物体，
	或者第2个盒子至少含有 `$ q_2 $` 个物体，
	…，
	或者第n个盒子至少含有 `$ q_n $` 个物体



特殊形式： `$ q_1 = q_2 = … = q_n= r  $` 时，
$$
q_1+q_2+…+q_n – n+1= n(r-1)+1
$$

2. 平均原理：

如果  `$ n $`  个非负整数  `$ m_1, m_2, …, m_n $`  的平均数大于  `$ r-1 $`  ，即  `$ \frac {(m_1+m_2+…+m_n)}{n} > r-1 $`  ，则至少有一个整数大于或等于 `$ r $` 。
设  `$ m $`  和  `$ n $`  都是正整数。如果  `$ m $`  个物体放入  `$ n $`  个盒子，则至少有一个盒子含有  `$ \lceil \frac{m}{n} \rceil $`  个或更多的物体。

> 理解

例:5个盒子 1+2+3+4+5-5+1=10

则不会出现:

	第一个盒子少于1个
	
	第二个盒子少于2个
	
	第三个盒子少于3个
	
	第四个盒子少于4个
	
	第五个盒子少于5个

这五个不会同时出现

> 方法

1. 最小物品数

2. 圆盘问题，二进制问题

### 3.3 Ramsey原理

> 简单形式

通俗实例： 在6个人中，

+ 或者有3个人，他们中每两个人都互相认识；
+ n 或者有3个人，他们中的每两个人都彼此不认识。

> 完全形式

用 `$ K_n $` 表示平面上没有3点共线的n个顶点构成
的一个完全图 (n阶完全图)

1.  `$ K_6 \rightarrow K_3,K_3 $` 

> Ramsey定理

如果m ≥ 2及n ≥ 2是两个整数，则一定存在正整数 p，使得 `$ K_p \rightarrow K_m,K_n $` 

> 定义

Ramsey数 `$ r(m, n) $`  是使  `$ K_p \rightarrow K_m,K_n $` 成立的最小整数 p

1.  `$ r(2,n)=n $` 
2.  `$ r(m,2)=m $` 

3.  `$ r(m, n) ≤ r(m-1, n) + r(m, n-1)，m, n≥ 3 $` 

> 推广

如果  `$ n_1, n_2,…, n_l $` 都是大于或等于 2 的整数则一定存在正整数 p，使得
$$
K_p \rightarrow K_{n_1},K_{n_2},...,K_{n_l}
$$
满足以上条件的最小整数 p 称为Ramsey数
$$
r(n_1,n_2,...,n_l)
$$

> 更一般的形式

给定整数  `$ t ≥2 $`  及整数  `$ q_1, q_2, …, q_k ≥ t $` ，则存在一个整数 p，
使得：如果将 p元素集合中每一个 t 元素子集指定为 k 种
颜色 `$ c_1, c_2,…, c_k $` 中一种，那么

+ 或者存在  `$ q_1 $`  个元素，其所有 t 子集被指定成颜色 `$ c_1 $` , 
+  … …, 
+ 或者存在  `$ q_k $`  个元素，其所有 t 子集被指定成颜色 `$ c_k $` , 

满足结论的最小整数 p 为Ramsey数  `$ r_t (q_1, q_2, …, q_k) $` 

令  `$ K_{N}^t $`  表示 n个元素集合中所有 t 个元素的子集的集合

给定整数  `$ t ≥2 $`  及整数 `$ q_1, q_2, …, q_k ≥ t $` ，存在一个整数 p, 使..得 `$ K_p^t \rightarrow K_{q_1}^t,K_{q_2}^t,...,K_{q_k}^t $` 

## 第4章 生成排列和组合

### 4.1 生成排列

#### 递归生成算法

#### 邻位对换算法

> 定义

如果整数 k 的箭头指向与其相邻但比它小的整数, 则称 k 是可移动（活动）的

> 算法

生成{1, 2, …, n}的排列算法:

1. 初始：% " … (；
2. while 存在活动整数时，do
    (1) 求出最大的活动整数 m
    (2) 交换 m 和其箭头指向的相邻整数的位置
    (3) 改变所有满足p>m的整数 p 的箭头方向。
3. 不存在活动整数时，算法结束。

> 结论：两种算法生成的排列顺序一致

### 4.2 排序中的逆序

> 定义

1. **逆序：**令 `$ i_1,i_2 ,…, i_n $`  是集合 `$ {1, 2, …, n} $` 的一个排列，如果 `$ 0 \leq k < l \leq n $` , 且 `$ i_k > i_l $`  , 称数对 `$ （i_k , i_l） $` 是排列的一个逆序。

2. **逆序数：**对于 { `$ {1, 2, …, n} $` } 上的一个排列，令  `$ a_j $`  表示第二元是  `$ j $`   的逆序的数量，即  `$ a_j $`  是排列中先于整数  `$ j $`  并大于  `$ j $`  的整数的个数，用于度量  `$ j $`  的反序程度。

3. **逆序列：**令  `$ a_j $`  表示排列  `$ i_1,i_2 ,…, i_n $`  中数  `$ j $`  的逆序数，称  `$ a_1,a_2 ,…, a_n $`  为排列  `$ i_1,i_2 ,…, i_n $`  的逆序列。

4. **奇排列、偶排列：**逆序个数为奇数的排列称为奇排列；逆序个数为偶数的排列称为偶排列


> 性质

性质1：排列  $i_1,i_2,…,i_n$  的逆序列  $a_1,a_2,…,a_n$  满足： $0\leq a_1\leq n-1,0\leq a_2\leq n-2,...,0 \leq a_{n-1}\leq1,a_n=0（1）$ 
性质2：满足条件（1）的序列  `$ a_1,a_2,…,a_n $`  有  `$ n! $`  个。

> 定理

1. 令  `$ b_1, b_2,…, b_n $`  为满足 `$ 0\leq b_1\leq n-1,0\leq b_2\leq n-2,...,0\leq b_{n-1}\leq1,b_n=0 $` 的整数序列，那么存在集合{  `$ 1, 2, …, n $`  }的唯一一个排列，满足它的逆序列为  `$ b_1, b_2,…, b_n $`  

2. n阶矩阵  `$ A=[a_{ij}] (i, j =1, 2, .., n) $` , 其行列式为  `$ det(A)= \Sigma \varepsilon (i_1i_2…i_n)a_{i_1}a_{i_2}…a_{i_n} $`  ,其中， `$ ε(i_1i_2…i_n) $` 是 `$ i_1i_2…i_n $` 的符号(偶排列为+1，奇排列为-1)

3. 已知排列  `$ i_1, i_2 ,…, i_n $`  的逆序列为 `$ b_1b_2 … b_n $` ，且  `$ k = b_1+ b_2+… + b_n $`  为逆序数。则可以通过  `$ k $`  次交换相邻两个数，转化为 `$ 1 2 … n $` 。

### 4.3 生成组合

#### 算法1：字典序的组合生成

通过特征函数，将n元集合 `$ S= $` { `$ {x_{n-1}, x_{n-2}, …, x_0} $` }的组合与长度 为 `$ n $`  的二进制数一一对应

算法按自然二进制数顺序生成， 称为n元
组字典序。

**子集的压缩序：**当 j<n-1时，{ `$ x_j, …, x_1, x_0 $` }的所有组合都在至少含有{ `$ x_{n-1},…, x_{j+1} $` }中一个元素的组合的前面

#### 算法2：发射Gray码序生成算法

##### 特点

相邻的组合仅相差一个元素（增加一个或者删除一个元素）

##### 定义

###### n阶Gray码

1. n 元组看作是 n 维空间的点的坐标。
2. 每两个点的坐标仅有一个位置不同时，有一条连线。
3. 算法生成所有的 n 元组：遍历 n 维空间的每个点，使得每个点与其后继只在一个位置不同。
4. 产生的路径称为n阶Gray码

###### 循环Gray码

遍历可以再经过一条边从终点返回到起点

###### n阶Gray反射码

1. 1阶反射Gray码是 0 或 1

2. 设 n>1 且 n-1 阶反射 Gray 码已经构造，如下构建 n 阶反射 Gray 码：
	(1) 以 n-1 阶反射 Gray 码所给出的顺序列出 0 和 1 的 n-1 元组，把 0 添到每个 n-1 元组的开头，
	(2) 再反序列出 n-1 阶反射 Gray 码的全部 n-1 元组, 并把1加到全部 n-1 元组的开头。
+ n 阶反射 Gray 码以 00…0 开始，并以 10…0 结束。
+ n 因为 00…0 与 10…0 只相差一位，因此该码是循环码。

递归方法构造反射 Gray 码，生成组合。

##### 算法

###### 逐次法

+ 以反射 Gray 码的顺序直接生成 0，1 的n元组

1. 初始： `$ a_{n-1}…a_1a_0＝0…00 $` 

2. 当  `$ a_{n-1}…a_1a_0 \neq 10…0 $`  时，进行以下操作：
    (1) 计算  `$ \sigma(a_{n-1}…a_1a_0) = a_{n-1}+…+a_1+a_0 $` 
    (2) 如果  `$ \sigma(a_{n-1}…a_1a_0) $` 是偶数，则改变  `$ a_0（0变1或1变0） $` 
    (3) 否则，确定  `$ j $` ，使得  `$ a_j=1 $`  且对于所有 `$ i< j, a_i
    ＝0 $` ，然后，改变 `$ a_{j+1}（0变1或1变0） $`  。

##### 定理

1. 对于每一个正整数 n ， 逐次法生成 n 阶反射Gray码

#### 总结

##### 字典序

+ 与二进制数顺序一致

##### 反射 Gray 码

+ 相邻两个子集相差一个元素

+ 递归法、逐次法

###### 确定 n 元组在 Gray 码序表的准确位置

给定 Gray 码  `$ a_{n-1}…a_1a_0 $`  . 对于  `$ i = 0, 1, …, n-1 $`  ， 设
$$
b_i = 0,若a_{n-1}+...+a_i是偶数\\
b_i = 1,若a_{n-1}+...+a_i是奇数
$$
此时，  `$ a_{n-1}…a_1a_0 $`  在 Gray码序表的位置和  `$ b_{n-1}…b_1b_0 $`  在字典序表上的位置相同。即  `$ a_{n-1}… a_1a_0 $`  在Gray码序表的位置是  `$ b_{n-1}×2^{n-1}+…+b_1×2 + b_0×2^0 $`  。

### 4.4 生成 r 子集

#### 定义

#####  r 子集的字典序

令  `$ S= $` { `$ 1, 2, …, n $` } 由前  `$ n $`  个正整数组成。

+ 给出 S 的元素的一个自然顺序:

$$
1 < 2 < … < n
$$

设  `$ A，B $`  是  `$ S $`  的两个  `$ r $`  组合，若  `$ A\cup B $`  \  `$ A\cap B $`  中的最小整数属于A，则称 A先于B

##### 组合表示为子序列

约定  `$ S= $` { `$ 1, 2, …, n $` } 的  `$ r $`  子集为如下形式：
 `$ a_1 a_2 … a_r $`  , 其中  `$ 1 ≤ a_1< a_2 < … < a_r ≤ n $` 

#### 性质

设  `$ S= $` { `$ 1, 2,…, n $` },  `$ a_1…a_r $` 是  `$ S $`  的一个  `$ r $`  子集。

+ (1) 对任意的 `$ 1≤ i < j ≤ r-1 $` ，

   `$ a_1…a_r $` 的以  `$ a_1…a_j $`  开头的第一个后继一定先于以  `$ a_1…a_i $`  开头的第一个后继（如果存在）。

+ (2) 如果  `$ a_r< n $`  , 则  `$ a_1…a_r $`  的直接后继为

    `$ a_1…a_{r-1}\textcolor {red}{a_r+1} $` 。

#### 定理

##### 4.4.1

###### (1) 

设  `$ a_1a_2…a_r $`  是 { `$ 1, 2, …, n $` } 的  `$ r $`  子集。在字典序中, 第一个  `$ r $`  子集是  `$ 12…r $` , 最后一个  `$ r $` 子集是  `$ (n-r+1)(n-r+2) … n $`  。  `$ a_1…a_{r-1} $`  不是最后一个  `$ r $`  子集。

###### (2) 

设  `$ a_1a_2…a_r \neq (n-r+1)(n-r+2)…n $`  。令  `$ k $`  是满足  `$ a_k < n $` 且使得  `$ a_k+1 $`  不同于  `$ a_1a_2…a_r $`  中任一数的最大整数。那么, 在字典序中,  `$ a_1a_2…a_r $`  的直接后继是：
$$
\textcolor{blue}{a_1a_2…a_{k-1}}
\textcolor{red}{(a_k+1)(a_k+2)…(a_k+r-k+1)}
$$

###### 直接后继求解算法

1. 当  `$ a_i<n $`  时  `$ (1≤ i ≤ r) $`  ， 求  `$ a_i+1 $`  , 判断  `$ a_i+1 $`  是否属于{ `$ a_1, …, a_r $` }；

2. 找出满足  `$ a_i < n $`  , 且  `$ a_i+1 $`  不在 {  `$ a_1,…, a_r $`  }中的最大的  `$ i $`  , 记为  `$ k $`  ，那么， 在字典序中，  `$ a_1a_2…a_r $`  的直接后继是 ：
   $$
   \textcolor{blue}{a_1a_2…a_{k-1}}
   \textcolor{red}{(a_k+1)(a_k+2)…(a_k+r-k+1)}
   $$

#### 字典序 r 子集的生成算法

##### { `$ 1, 2,…, n $` }的字典序  `$ r $`  子集的生成算法：

从  `$ 12…r $`  开始，逐个列出直接后继，直至得到  `$ (n-r+1)(n-r+2)…n $` 

1. 初始：  `$ a_1a_2…a_r＝12…r $` ；
2. 当  `$ a_1a_2…a_r \neq(n-r+1)(n-r+2)…n $`  时，进行以下操作：
(1) 确定最大整数k, 使得 `$ a_k+1\leq n，且 a_k+1\neq a_i (i=1,2,…,r) $` ；
(2) 用  `$ a_1a_2…a_{k-1} (a_k+1)…(a_k+r-k+1) $`  替换   `$ a_1a_2…a_r $`  .

#### 定理

##### 4.2.2

 {  `$ 1, 2,…, n $`  }的  `$ r $`  子集  `$ a_1a_2…a_r $`  出现在 { `$ 1, 2, …, n $` }的  `$ r $`  子集中的字典序中的位置号为：
$$
{{n}\choose{r}}-
{{n-a_1}\choose{r}}-
{{n-a_2}\choose{r-1}}...-
{{n-a_{r-1}}\choose{2}}-
{{n-a_r}\choose{1}}
$$

## 第5章 二项式系数

#### 组合证明

是一种依靠计数原理构建代数事实的证明方法

基本框架：
1. 定义一个集合  `$ S $`  ；
2. 通过一种计数方式得出  `$ |S|= n $`  ；
3. 通过另一种计数方式得出  `$ |S|= m $`  ；
4. 得出结论  `$ n = m $` 。

#### 二项式定理

令  `$ n $`  是一个正整数, 那么对于所有的  `$ x, y $`  有：
$$
(x+y)^{n}= \sum_{k=0}^{n} {n\choose k}x^{n-k}y^{k}
$$
其中：
$$
{n\choose k}= \frac {n!}{k!(n-k)!}=\frac {n(n-1)...(n-k+1)}{k(k-1)...1}
$$

### 5.1 帕斯卡三角形

#### 定理

##### 5.1.1

( Pascal 公式) 对于满足  `$ 1\leq k \leq n $`  的所有整数  `$ k $`  和  `$ n $`  , 有：
$$
{n\choose k}={n-1\choose k}+{n-1\choose k-1}
$$

### 5.2 二项式定理

#### 定理

##### 5.2.1

令  `$ n $`  是一个正整数, 那么对于所有的  `$ x, y $`  有：
$$
(x+y)^{n}= \sum_{k=0}^{n} {n\choose k}x^{n-k}y^{k}
$$

##### 二项式系数的其他等式

$$
k{n \choose k}=n{n-1 \choose k-1}
$$

#### 方法

##### 证明等式的方法

+ 利用已有等式：帕斯卡公式
+ 求导法、积分法
+ 组合推理法

#### 性质

##### 组合推理路径数

从  `$ (0,0) $`  点到  `$ (m,n) $`  点，共有  `$ {m+n \choose m} = {m+n \choose n} $`  种路径 

#### 组合定义扩展

$$
{n\choose k}=
\frac {n!}{k!(n-k)!}=
\frac {n(n-1)...(n-k+1)}{k(k-1)...1}
$$

扩展：

+  `$ \textcolor{red}{n}扩展为\textcolor{red}{任意实数} $` 
+  `$ \textcolor{blue}{k}扩展为\textcolor{blue}{任意整数} $` 

令  `$ \textcolor{red}{r} $`  可取 `$ \textcolor{red}{任意实数} $` ,  `$ \textcolor{blue}k $`  可取 `$ \textcolor{blue}{任意整数（正的、负的或零）} $` , 
定义二项式系数  `$ r\choose k $`  为：
$$
{r\choose k}=\left\{ 
\begin{array}{rcl}
x & = & \frac{r(r-1)...{r-k+1}}{k!} 
&, 若k \geq 1\\ 
y & = & 1 
&, 若k = 0\\ 
z & = & 0 
&, 若k \leq -1 
\end{array}
\right.
$$

+ 扩展定义  `$ n\choose k $`  仍使Pascal公式成立

+ 令  `$ \textcolor{red}{r} $`  可取 `$ \textcolor{red}{任意实数} $` ,  `$ \textcolor{blue}k $`  可取 `$ \textcolor{blue}{任意整数} $` ，仍有：
  $$
  {r\choose k}={r-1\choose k}+{r-1\choose k-1}\\
  k{r \choose k}=r{r-1 \choose k-1}
  $$

### 5.3 二项式系数的单峰性

#### 定义

##### 单峰性

设序列  `$ s_0,s_1,s_2,…,s_n $`  , 若存在一个整数  `$ t $`  ,  `$ 0 \leq t \leq n $`  , 使得:
$$
s_0 \leq s_1 \leq s_2 \leq ... \leq s_t，
s_t \geq s_{t+1} \geq s_{t+2} \geq ... \geq s_n
$$
那么, 称序列是 `$ \textcolor{red}{单峰} $` 的。

###### 注意

1.   `$ s_t $`  一定是序列中的最大数
2.   `$ t $`  不一定是唯一的

##### 取整

设  `$ x $`  为任意实数, 令  `$ \lceil x \rceil $`  表示大于或等于  `$ x $`  的最小整数,称强取整(上取整);  `$ \lfloor x \rfloor $`  表示小于或等于  `$ x $`  的最大整数,称弱取整(下取整).

#### 定理

##### 5.3.1

令  `$ n $`  为正整数, 二项式系数序列是 `$ \textcolor{red}{单峰序列} $` ,其中：

+ 若  `$ n $`  是偶数：

$$
{n\choose0}<{n\choose1}<...<{n\choose n/2}，
{n\choose n/2}>...>{n\choose n-1}>{n\choose n}
$$



+ 若  `$ n $`  是奇数：

$$
{n\choose0}<{n\choose1}<...<{n\choose (n-1)/2}，
{n\choose (n+1)/2}>...>{n\choose n-1}>{n\choose n}
$$

##### 5.3.2

二项式系数  `$ {n\choose 0},{n\choose 1},...,{n\choose n} $`  的最大者是：

+  `$ {n\choose \lfloor n/2 \rfloor} = {n\choose \lceil n/2 \rceil} = {n\choose n/2 } $`  (  `$ n $`  为偶数时)
+  `$ {n\choose \lfloor n/2 \rfloor} = {n\choose \lceil n/2 \rceil} = {n\choose (n-1)/2 } == {n\choose (n+1)/2 } $`  (  `$ n $`  为奇数时)

#### 扩展 1

+ 由集合的子集的包含关系定义的链与反链
+ 由包含关系推广到一般偏序

##### 定义

###### 反链

令  `$ S $`  是  `$ n $`  个元素的集合，  `$ S $`  上的一条反链是  `$ S $`  的子集的一个集合  `$ A $`  ，其中  `$ A $`  中的子集不相互包含。

###### 链

令  `$ S $`  是  `$ n $`  个元素的集合,   `$ S $`  上的一条链是  `$ S $`  的子集的集合  `$ C $`   ，其中对于  `$ C $`  中的每一对子集，总有一个包含在另一个之中：
对任意  `$ S_1,S_2\in C $`  ，且  `$ S1 \neq S2 $`  ，则  `$ S1 \subset S2 $`  或者  `$ S2 \subset S1 $` 

###### 最大链

令  `$ S $`  是  `$ n $`  个元素的集合,  `$ S $`  上的最大链  `$ C $`  定义为： `$ C = {A_0, A_1, …, A_n} $` ，
满足:
(1)  `$ A_0= Φ \subset A_1 \subset A2…\subset An $` , 且
(2)  `$ | A_i | = i (i =1, …, n) $` 

##### 方法

###### 构造反链

令  `$ S $`  为  `$ n $`  个元素的集合，一个构造反链的方法：

选择一个整数  `$ k \leq n $`  ，取  `$ A_k $`  为  `$ S $`  所有的  `$ k $`  子集的集合。该方法构成的反链最多含有  `$ n \choose \lfloor n/2 \rfloor $`  个子集。

###### 构造最大链

1.   `$ A_0= Φ $` 

2. 从  `$ S $`  中选择一个元素  `$ i_1 $`  , 形成  `$ A_1= $` { `$ i_1 $` }.

3. 选择一个元素  `$ i_2 \neq i_1 $` , 形成  `$ A_2= $` { `$ i_1, i_2 $` }.

4. 选择一个元素  `$ i_3 \neq i_1, i_2 $`  形成  `$ A_3= $` { `$ i_1, i_2, i_3 $` }.

	…

   k. 选择一个元素  `$ i_k \neq i_1, i_2,…, i_{k-1} $`  形成  `$ A_k= $` { `$ i_1, i_2, …, i_k $` }.
	…
   n. 选择一个元素  `$ i_n \neq i+1,…, i+{n-1} $`  形成  `$ An= $` { `$ i_1, i_2, …, i_n $` }.

+ S上的最大链与 S 的排列一一对应
+ 最大链的数目为  `$ n! $` 

##### 链与反链的关系

+   `$ S $`  上的一条链最多只能包含  `$ S $`  的任意一条反链中的一个子集
+   `$ S $`  上的一条反链最多只能包含  `$ S $`  的任意一条链中的一个子集

##### 定理

###### 5.3.3

设  `$ S $`  为  `$ n $`  个元素的集合，则  `$ S $`  上的一条反链最多包含  `$ n\choose \lfloor n/2 \rfloor $`  个子集

###### 更强的结果

设  `$ S $`  是为  `$ n $`  个元素的集合，

+ 如果n是偶数，则大小为  `$ n\choose \lfloor n/2 \rfloor $`  的唯一的反链是所有  `$ n/2 $`  子集的反链
+ 如果n是奇数，则大小为  `$ n\choose \lfloor n/2 \rfloor $`  的反链有两个：
  + 所有  `$ (n-1)/2 $`  子集构成的反链；
  + 所有  `$ (n+1)/2 $`  子集构成的反链。

#### 扩展 2

+ 集合的包含关系是偏序关系
+ 把链、反链的概念推广到偏序集

令  `$ ( X,\leq ) $`  是一个有限偏序集,

+ 链是  `$ X $`  的一个子集, 其中任意两个元素都是可比的,
+ 反链是  `$ X $`  的一个子集, 其中任意两个元素都不可比.

+ 极小元：  `$ a $`  是偏序集的极小元当且仅当  `$ X $`  中不存在
  满足  `$ x < a $`  的元素  `$ x $`  
  +  `$ X $`  的所有极小元构成的子集是反链
+ 极大元：  `$ av 是偏序集的极大元当且仅当  `$ X $`  中不存在
  满足  `$ x > a $`  的元素  `$ x $` 
  +  `$ X $`  的所有极大元构成的子集也是反链

##### 定理

###### 5.6.1

令  `$ ( X, \leq ) $`  是一个有限偏序集, 并令  `$ r $`  是最大链的大小, 则  `$ X $`  可以被划分成  `$ r $`  个反链，但不能划分为少于  `$ r $`  个的反链。

###### 5.6.2

令  `$ (X, \leq) $`  是一个有限偏序集, 并令  `$ m $`  是最大反链的大小, 则  `$ X $`  可以被划分成  `$ m $`  个链，但不能划分成少于  `$ m $`  个链

##### 定义

###### 对称链划分

设  `$ S= $` { `$ 1, 2,…, n $` }， 如果  `$ S $`  的幂集  `$ P(S) $`  的一个链划分满足以下两个条件，则称其是一个对称链划分：
(1) 链中每一个子集比它前面的子集的元素个数多  `$ 1 $`  ；
(2) 链中第一个子集与最后一个子集的大小和等于  `$ n $`  。
如果这个链只含一个子集，那么这个子集既是第一个子集也是最后一个子集，所以其大小为  `$ n/2 $`  (此时，  `$ n $`  为偶数)

##### 方法

###### 对称链划分的构造方法

**基本思路**：将  `$ S $`  的所有子集划分为  `$ {n\choose \lfloor n/2 \rfloor} $`  个对称链。令  `$ S= $` { `$ 1, 2, …, n $` } ，对  `$ n $`  进行归纳构造：

对于  `$ n=k $`  时的每一个含多个子集的链  `$ E $` ，可构造  `$ n=k+1 $`  时的两个链：
1. 对  `$ E $`  增加如下子集：在  `$ E $`  的最后一个子集中增加  `$ k+1 $`  ，构成一个新子集
2. 把  `$ k+1 $`  加到  `$ E $`  中除最后一个子集之外的所有子集，并删除最后一个子集

**注意：**

+ 对称链划分中的每一个链必须正好含有一个  `$ \lfloor n/2 \rfloor $`  子集（也正好含有一个  `$ \lceil n/2 \rceil $`  子集）
+ 对称链划分中的链的个数等于： `$ {n\choose \lfloor n/2 \rfloor }= {n \choose \lceil \lceil n/2 \rceil \rceil} $` 

### 5.4 多项式定理

#### 定义

+ 把二项式定理  `$ (x+y)^n $`  扩展到  `$ (x_1+x_2+…+x_t)^n $` 
+ 多项式系数： `$ {n\choose n_1n_2...n_t}={\frac{n!}{n_1!n_2!...n_t!}} $` , 其中  `$ n_1, n_2, … n_t $`  是非负整数，且  `$ n_1+n_2+…+n_t=n $` 
+ + 表示重数分别为  `$ n_1, n_2, … n_t $`  的  `$ t $`  种不同类型物品的多重集的排列数
  + 二项式系数：  `$ {n\choose r}={\frac {n!}{r!(n-r)!}} $`  , 可记为  `$ n\choose r\quad n-r $` 

#### 定理

##### 帕斯卡公式

+ 二项式系数的帕斯卡公式 

$$
{n\choose k\quad n-k}=
{n-1\choose k\quad n-k-1}+
{n-1\choose k-1\quad n-k}
$$

+ 多项式系数的帕斯卡公式

$$
{n\choose n_1\quad n_2\quad ... n_t}=
{n-1\choose n_1-1\quad n_2\quad ... n_t}+
{n-1\choose n_1\quad n_2-1\quad ... n_t}+
...+
{n-1\choose n_1\quad n_2\quad ... n_t-1}
$$

##### 5.4.1

设 n是正整数。对于所有的  `$ x_1, x_2,…, x_t $`  , 有

$$
(x_1+x_2+...+x_t)^n=\Sigma{n\choose n_1\quad n_2\quad ... n_t}
x_1^{n_1}x_2^{n_2}...x_t^{n_t}
$$
其中求和是对  `$ n_1+n_2+…+n_t=n $`  的所有非负整数解  `$ n_1, 
n_2, …, n_t $`  进行的。

### 牛顿二项式定理

#### 定理

##### 5.5.1

令  `$ a $`  是一个实数, 对于所有满足  `$ 0 \leq |x|< |y| $`  的变量  `$ x , y $`  有
$$
(x+y)^{\alpha}=\Sigma^{\infty}_{k=0}{\alpha \choose k}x^ky^{\alpha -k}
$$
其中， `$ {\alpha\choose k} = \frac{\alpha(\alpha -1)...(\alpha - k +1)}{k!} $` 

如果  `$ \alpha $`  为整数，则就是二项式定理

###### 等价形式

对满足  `$ |z|<1 $`  的任意  `$ z $`  ，有  `$ (1+z)^{-n}=\Sigma^{\infty}_{k=0}(-1)^k{n+k-1 \choose k}z^k $`  

#### 应用

##### 求解任意精度平方根

令  `$ \alpha =1/2 $`  ，有  `$ {\alpha \choose 0}=1 $`  ，对于  `$ k>0 $`  有：
$$
{\alpha \choose k}={1/2 \choose k}=\frac{(-1)^{k-1}}{k\times 2^{2k-1}}{2k-2 \choose k-1}
$$
因此，对  `$ |z|<1 $`  ，有：
$$
\sqrt{1+z} = (1+z)^{1/2} = 1+\sum^{\infty}_{k=1}\frac{(-1)^{k-1}}{k \times 2^{2k-1}}{2k-2 \choose k-1}z^k\\
=1+\frac{1}{2}z-
\frac{1}{2\times2^3}{2\choose1}z^2+
\frac{1}{3\times2^5}{4\choose2}z^3-
...
$$
(详细证明见ppt)

## 第6章 容斥原理及应用

### 6.1 容斥原理

#### 定义

##### 计数函数：  `$ \sigma_x(A) $` 

$$
\sigma _x(A)=
\left\{\begin{matrix}
1,x\in A \\
0,x\notin A
\end{matrix}\right.
$$

#### 定理和推论

设集合  `$ A_i $`  是集合S中满足性质  `$ P_i $`  的所有物体的子集，  `$ i =1, 2, …, m $`  , 则

##### 6.1.1

集合  `$ S $`  不具有性质  `$ P_1,P_2,…,P_m $`  的物体的个数：
$$
|\overline{A_1}\cap...\cap \overline{A_m}|
=
|S|-\sum|A_i|+\sum|A_i\cap A_j|
-\sum|A_i \cap A_j \cap A_k|+...+
(-1)^m|A_1\cap A_2\cap...\cap A_m|
$$

##### 6.1.2

集合  `$ S $`  至少具有性质  `$ P_1,P_2,…,P_m $`  之一的物体的个数：
$$
|A_1\cup A_2...\cup A_m|
=
\sum|A_i|-\sum|A_i\cap A_j|
+\sum|A_i \cap A_j \cap A_k|+...+
(-1)^{m+1}|A_1\cap A_2\cap...\cap A_m|
$$


其中，第一个和对  `$ \lbrace 1, 2, …, m \rbrace $`  的所有的 1 子集  `$ \lbrace i\rbrace $`  进行, 第二个和对  `$ \lbrace 1, 2, …, m \rbrace $`  的所有的 2 集合  `$ \lbrace i,j\rbrace $`  进行, 依此类推

##### 特别情况

若：
$$
\begin{aligned}
& \alpha_1=|A_1|=|A_2|=…=|A_m|
(所有集合包含的元素个数相等)\\
& \alpha_2=|A_1∩A_2|=…=|A_{m-1}∩A_m|
(任意两个集合的交包含相等个数的元素)\\
& \alpha_3=|A_1∩A_2∩A_3|=…=|A_{m-2}∩A_{m-1}∩A_m|
(任意三个集合的交包含相等个数的元素个数）)\\
& … \\
& \alpha_k =|A_1∩ … ∩A_k|=…=|A_{m-k+1}∩…∩A_m|\\
& … \\
& \alpha_m=|A_1∩A_2∩ …∩A_m|
\end{aligned}
$$
则，
$$
\begin{aligned}
&\overline {A_1} \cap ... \cap  \overline {A_n}\\
&= \alpha_0 - {m\choose1}\alpha_1 + {m\choose2}\alpha_2 -{m\choose3}\alpha_3 + ... + (-1)^k{m\choose k}\alpha_k+...+(-1)^m\alpha_m
\end{aligned}
$$

### 6.2 带重复的组合

#### 多重集组合与方程整数解个数

<a id="6.2">6.2 带重复的组合</a>
[回顾一下2.5](#2.5)

多重集  `$ T=\lbrace n_1×a_1, n_2×a_2,…, n_k×a_k \rbrace $`  的  `$ r $`  组合数等于方程
$$
x_1+x_2+ …+x_k=r,\\
0\leq x_1\leq n_1, 
0\leq x_2\leq n_2, 
…, 
0\leq xk \leq n_k
$$

的整数解的个数。

### 6.3 错位排列

#### 定义

##### 1.

设  `$ X=\lbrace 1, 2, …, n\rbrace $`  , 它的排列用  `$ i_1i_2…i_n $`  表示。错位排列是使得  `$ i_1\neq1, i_2\neq2,…, i_n\neq n $`  的排列。用  `$ D_n $`  表示错位排列个数

#### 定理

##### 6.3.1

对  `$ n \geq 1 $` ，
$$
D_n = n!(1-\frac{1}{1!}+\frac{1}{2!}-\frac{1}{3!}+...+(-1)^n\frac{1}{n!})
$$

#### 性质

##### 错位排列的递推关系

###### 1

$$
D_n= (n-1)(D_{n-2}+D_{n-1}), (n=3,4 ...)\\
D_2=1 ; D_1=0
$$

###### 2

$$
D_n=nD_{n-1}+(-1)^n
$$

### 6.4 带有禁止位置的排列

#### 定义

##### (1) 带有禁止位置的排列

令  `$ X_1 , X_2 , … , X_n $`  是  `$ \lbrace1, 2, …, n\rbrace $`  的子集 (可以为空集)，用  `$ P(X_1 , X_2 , … , X_n) $`  表示  `$ \lbrace1, 2, …, n\rbrace $`  的排列  `$ i_1i_2…i_n $`  的集合，使得：  `$ i_1\notin X_1，i_2 \notin X_2，…， i_n \notin X_n $` 

记  `$ p(X_1 , X_2 , … , X_n)=|P(X_1 , X_2 , … , X_n)| $` ，表示  `$ P(X_1 , X_2 , … , X_n) $`  中排列的个数。

##### (2) 带禁止位置的“非攻击性车”

  `$ \lbrace 1, 2, …, n \rbrace $`  的排列  `$ i_1 i_2… i_n $`  对应于棋盘上以方格
$$
(1, i_1), (2, i_2),…, (n, i_n)
$$
为坐标的n个车的位置

满足第  `$ j $`  行的车不在  `$ X_j $`  中的列，  `$ j=1, 2,…, n $`  ，共有多少种放置非攻击型车的方法。

#### 定理

##### 6.4.1

将  `$ n $`  个非攻击型不可区分的车放到带有禁止位置的  `$ n×n $`  的棋盘中，放法总数等于：
$$
n!-r_1(n-1)!+r_2(n-2)!-…+(-1)^kr_k(n-k)!+…+(-1)^nr_n
$$
  `$ r_1, r_2,…, r_n $`  的计算依赖于具体的问题！

+ 任意两个车不在同一行或同一列
+ 所有的  `$ k $`  个车放置在其禁止位置上的放置方法数，  `$ k=1, 2, …, n $` 
+   `$ r_k $`  的计算不考虑剩下的  `$ n-k $` 个车的放置

### 6.5 另一个禁止位置问题

#### 定义

##### 相对禁止位置排列计数  `$ Q_n $` 

 `$ Q_n $` ：  `$ \lbrace1, 2,…, n\rbrace $`  的排列中没有  `$ 12, 23, …, (n-1)n $`  这些 模式出现的排列的个数

#### 定理

##### 6.5.1

对于  `$ n\geq 1 $` ，
$$
\begin{aligned}
Q_n &= n! + \Sigma^{n-1}_{k=1}(-1)^k{{n-1}\choose{k}}(n-k)!\\
&=n!-{n-1\choose1}(n-1)!+
{n-1\choose2}(n-2)!+...+
(-1)^{n-1}{n-1\choose n-1}1!
\end{aligned}
$$

#### 例题

##### 旋转木马问题

看ppt去

#### 相对禁止  `$ Q_N $`  与错位排列  `$ D_n $`  的关系

#####  `$ Q_n = D_n + D_{n-1} $` 

## 第7章 递推关系和生成函数

生成函数(也称母函数)核心思想：

+ 把离散数列和幂级数一一对应起来，

  把离散数列间的相互结合关系对应成为幂级数间的运算关系

+ 由幂级数形式来确定 离散数列 的构造

### 7.1 若干数列

#### 定义

##### 斐波那契数列

设有数列  `$ f_0, f_1, f_2,…, f_n, … $` 。如果
 `$ f_0=0, f_1=1 $` , 且满足递推关系  `$ f_n= f_{n-1}+f_{n-2}，n\geq2 $` 
称该数列为斐波那契（Fibonacci）数列，这个数列的项称为斐波那契数

#### 定理

##### 7.1.1

斐波那契数  `$ f_n $`  满足公式
$$
f_n=\frac{1}{\sqrt{5}}(\frac{1+\sqrt{5}}{2})^n-
\frac{1}{\sqrt{5}}(\frac{1-\sqrt{5}}{2})^n,n\geq0
$$

##### 7.1.2

沿  `$ Pascal $`  三角形从左下到右上的对角线上的二项式系数和是斐波那契数, 即
$$
f_n={{n-1}\choose{0}}+
{{n-2}\choose{1}}+
{{n-3}\choose{2}}+...+
{{n-t}\choose{t-1}}
$$
其中， t= `$ \lfloor{\frac{m+1}{2}}\rfloor $` 

#### 性质

##### 斐波那契数列

###### 斐波那契数列的项的部分和

$$
s_n=f_0+f_1+f_2+...+f_n=f_{n+2}-1
$$

###### 斐波那契数是偶数当且仅当n被3整除

###### 斐波那契数能被3整除当且仅当n可被4整除

###### 斐波那契数能被4整除当且仅当n可被6整除

###### Fibonacci数列与黄金分割数

$$
\lim\limits_{x\rightarrow\infty}\frac{f_n}{f_{n+1}}=\frac{\sqrt{5}-1}{2}
\approx
0.618
$$

### 7.2 生成函数

涉及一个整数参数  `$ n $`  的某些计数问题的代数求解方法：生成函数（母函数）

#### *常见展开式

$$
\begin{aligned}
(1+x)^n&=\Sigma^n_{k=0}{n\choose k}x^k\\
(1-x)^n&=\Sigma^n_{k=0}(-1)^k{n\choose k}x^k
\end{aligned}
$$

对满足  `$ |x|<1 $`  的任意  `$ x $`  ，有：
$$
\begin{aligned}
\frac{1}{(1+x)^n}&=\Sigma^{\infty}_{k=0}(-1)^k{n+k-1\choose k}x^k\\
\frac{1}{(1-x)^n}&=\Sigma^{\infty}_{k=0}{n+k-1\choose k}x^k
\end{aligned}
$$
 `$ n=1 $`  时，得：
$$
\begin{aligned}
\frac{1}{1+x}&=\Sigma^{\infty}_{k=0}(-1)^kx^k \quad (|x|<1)\\
\frac{1}{1-x}&=\Sigma^{\infty}_{k=0}x^k \quad (|x|<1)
\end{aligned}
$$
令  `$ x=y^m $`  ，得：
$$
\begin{aligned}
\frac{1}{1+y^m}&=\Sigma^{\infty}_{k=0}(-1)^ky^{mk} \quad (|y|<1)\\
\frac{1}{1-y^m}&=\Sigma^{\infty}_{k=0}y^{mk} \quad (|y|<1)
\end{aligned}
$$

#### 生成函数的定义

令  `$ h_0, h_1,…,h_n,… $`  为一无穷数列, 其生成函数  `$ g(x) $`  定义为：
$$
\begin{aligned}
g(x) &= h_0+ h_1 x + h_2 x^2 +…+ h_n x^n+…\\
&=\Sigma_{k=0}^\infty h_kx^k
\end{aligned}
$$
有限数列  `$ h_0, h_1,…,h_n $`  可以看作是无限数列  `$ h_0, h_1,…,h_n,0,...,0,... $` 

适合多重集组合

#### 生成函数——多重集组合

##### 求生成函数

设  `$ k $`  是正整数，  `$ h_n $`  等于方程
$$
e_1+e_2+…+e_k=n
$$
的非负整数解个数，

即  `$ h_n $`  为多重集  `$ S=\lbrace∞\cdot a_1,∞\cdot a_2, …,∞\cdot a_k\rbrace $`  的   `$ n $`  组合个数，  `$ e_i $`  表示在一个  `$ n $`  组合中  `$ a_i $`  出现的次数。
$$
\begin{aligned}
g(x)&=\Sigma^\infty_{n=0}{n+k-1\choose n}x^n=\frac{1}{(1-x)^k}\\
&=(\Sigma^\infty_{e_1=0}x^{e_1})(\Sigma^\infty_{e_2=0}x^{e_2})...(\Sigma^\infty_{e_k=0}x^{e_k}) \quad(2)\\
&=\Sigma^\infty_{e_1+...+e_k=n=0}x^{e_1}x^{e_2}...x^{e_k}
\end{aligned}
$$


当  `$ n $`  组合中  `$ a_i $`  的出现次数有约束时，将反映到  `$ (2) $`  式的第  `$ i $`  个因子中。

##### 求通项

把生成函数向根本形式： `$ \Sigma_{k=0}^\infty h_kx^k $`  化简

#### 排列逆序

记  `$ \pi $`  中的逆序的数目为  `$ inv(\pi) $` 

设  `$ h(n, t) $`  表示  `$ \lbrace1, 2, …, n\rbrace $`  的排列中有  `$ t $`  个逆序的排列的数目，则：

+ 对于 `$ 0 \leq t \leq n(n-1)/2 $` ，有  `$ h(n,t)≥1 $` 
+ 对  `$ t >n(n-1)/2 $`  ，有  `$ h(n,t) =0 $` 

#### 定理

##### 7.2.1

设  `$ n $`  是正整数，则数列  `$ h(n, 0), h(n,1),…, h(n, n(n-1)/2) $`  的生成函数为
$$
g_n(x)=1(1+x)(1+x+x^2)…(1+x+…+x^{n-1}) = \frac{\Pi^n_{j=1}(1-x^j)}{(1-x)^n} \quad (1)
$$

### 7.3 指数生成函数

#### 指数生成函数的定义

数列  `$ h_0, h_1, h_2,…, h_n ,… $`  的指数生成函数定义为
$$
\begin{aligned}
g(x)&=h_0+h_1x+h_2\frac{x^2}{2!}+...+h_n\frac{x^n}{n!}+...\\
&=\Sigma_{k=0}^\infty h_k\frac{x^k}{k!}
\end{aligned}
$$

#### 例

#####  `$ P(n,k) $` 

设  `$ n $`  是正整数。确定下面数列的指数生成函数：
$$
P(n, 0), P(n, 1), P(n, 2), …, P(n, n)
$$
其中， `$ P(n,k) $`  表示  `$ n $`  元素集合的  `$ k $`  排列的数目，即
$$
P(n,k)=\frac{n!}{(n-k)!}
$$

#####  `$ e^x $` 

求数列  $ 1, 1, 1, …, 1,… $  的指数生成函数
$$
g(x)=\Sigma^\infty_{n=0}\frac{x^n}{n!}=e^x\quad(泰勒级数)
$$

#### 多重集排列

考虑由n个元素组成的多重集
$$
S=\lbrace n_1\cdot a_1, n_2\cdot a_2,…, n_k\cdot a_k \rbrace 
$$
其中  $ n=n_1+n_2+…+n_k $ 。从中取  $ r $  排列。

若  $ r=n $  ，则考虑  $ n $  个元素的全排列，不同的排列数为
$$
\frac{n!}{n_1!n_2!...n_k!}
$$
若  $ r<n $  

由组合生成排列——即先选后全排列

##### 有限重数

 $ S =\lbrace n_1\cdot a_1, n_2\cdot a_2,n_3\cdot a_3\rbrace $  的  $ r $  排列数  $ h_r $  ，  $ r = 0, 1, 2, …, n_1+n_2+n_3 $ 

 $ h_0,h_1,h_2,...,h_{n_1+n_2+n_3} $  的指数生成函数：
$$
(1+\frac{x}{1!}+\frac{x^2}{2!}+...++\frac{x^{n_1}}{n_1!})
(1+\frac{x}{1!}+\frac{x^2}{2!}+...++\frac{x^{n_2}}{n_2!})
(1+\frac{x}{1!}+\frac{x^2}{2!}+...++\frac{x^{n_3}}{n_3!})
$$
展开后  $ x^r $  前的系数为：
$$
\sum_{\substack{
e_1+e_2+e_3=r\\
0\leq e_1 \leq n_1,0\leq e_2 \leq n_2,0\leq e_3 \leq n_3
}}
\frac{x^{e_1}x^{e_2}x^{e_3}}{e_1!e_2!e_3!}\\
=(\sum_{\substack{
e_1+e_2+e_3=r\\
0\leq e_1 \leq n_1,0\leq e_2 \leq n_2,0\leq e_3 \leq n_3
}}\frac{r!}{e_1!e_2!e_3!})\frac{x^r}{r!}
$$
此处：
$$
h_r=(\sum_{\substack{
e_1+e_2+e_3=r\\
0\leq e_1 \leq n_1,0\leq e_2 \leq n_2,0\leq e_3 \leq n_3
}}\frac{r!}{e_1!e_2!e_3!})
$$
故指数生成函数为：
$$
\sum_{r=0}^{n_1+n_2+n_3}(\sum_{\substack{
e_1+e_2+e_3=r\\
0\leq e_1 \leq n_1,0\leq e_2 \leq n_2,0\leq e_3 \leq n_3
}}\frac{r!}{e_1!e_2!e_3!})\frac{x^r}{r!}
$$

#### 定理

##### 7.3.1

设  $ S $  是多重集  $ \lbrace n_1\cdot a_1, n_2\cdot a_2,…, n_k\cdot a_k \rbrace $  ，其中  $ n_1,n_2, …,n_k $  是非负整数。设  $ h_n $  是  $ S $  的  $ n $  排列数，那么数列  $ h_1, h_2,…,h_k… $  的指数生成函数  $ g $  为：
$$
g=f_{n_1}(x)f_{n_2}(x) ...f_{n_k}(x) 
$$
其中，对于  $ i=1,2,..,k $  ，有
$$
f_{n_i}(x)=1+x+\frac{x^2}{2!}+...+\frac{x^{n_i}}{n_i!}
$$

###### 推广到无穷重数

设  $ S $  是多重集  $ \lbrace \infty\cdot a_1, \infty\cdot a_2,…, \infty\cdot a_k \rbrace $  。设  $ h_n $  是  $ S $  的  $ n $  排列数，那么数列  $ h_0,h_1, h_2,…,h_k… $  的指数生成函数  $ g $  为：
$$
\begin{aligned}
g(x)&=h_0+h_1x+h_2\frac{x^2}{2!}+...+h_n\frac{x^n}{n!}+...\\
&=f_\infty(x)f_\infty(x)...f_\infty(x)\qquad(k个因子)
\end{aligned}
$$
其中：
$$
f_\infty(x)=1+x+\frac{x^2}{2!}+...+\frac{x^n}{n!}+...=e^x
$$
当  $ n $  排列中  $ a_i $  的出现有约束时，将反映到第  $ i $  个因子中

#### *常用展开式

$$
e^x=\Sigma^\infty_{n=0}\frac{x^n}{n!}=1+x+\frac{x^2}{2!}+...+\frac{x^n}{n!}+...\\
e^{-x}=\Sigma^\infty_{n=0}(-1)^n\frac{x^n}{n!}=1-x+\frac{x^2}{2!}+...+(-1)^n\frac{x^n}{n!}+...\\
\frac{1}{2}(e^x+e^{-x})=1+\frac{x^2}{2!}+\frac{x^4}{4!}+...+\frac{x^{2n}}{2n!}+...\\
\frac{1}{2}(e^x-e^{-x})=x+\frac{x^3}{3!}+\frac{x^5}{5!}+...+\frac{x^{2n+1}}{(2n+1)!}+...\\
$$

### 7.4 求解线性齐次递推关系

#### 定义

##### 线性齐次递推关系

令  $ h_0, h_1, h_2,…, h_n,… $  是一个数列。若存在量  $ a_1, a_2, …, a_k (a_k≠0) $ 和量  $ b_n $  （每个量是常数或依赖于  $ n $  的数）使得:
$$
h_n=a_1h_{n-1}+a_2h_{n-2}
+…+
a_{k-1}h_{n-k+1}+a_kh_{n-k}+ b_n
\quad
(n\geq k)
$$
则称该数列满足  $ k $  阶线性递推关系。
若  $ b_n= 0 $  ，则称该数列是  $ k $  阶线性**齐次**递推关系。
若  $ a_1, a_2, …, a_k $  都为常数，则称该数列是  $ k $  阶**常系数**线性递推关系。

###### 解法

本节重点讨论  $ k $  阶**常系数**线性**齐次**递推关系

+ 特征方程法
+ 生成函数法

#### 定理

##### 7.4.1(特征方程法)

令  $ q $  为一个非零数, 则  $ h_n= q^n $  是常系数线性齐次递推关系
$$
h_n
=a_1h_{n-1}+a_2h_{n-2}+…+a_kh_{n-k}\quad(a_k≠0, n≥k) (1)
$$
的解当且仅当  $ q $  是多项式方程**（特征方程）**
$$
x^k - a_1x^{k-1} - a_2x^{k-2}-…-a_{k-1}x - a_k=0\quad(2)
$$
的一个根。**（特征根）**

若多项式方程  $ (2) $  有 k个不同的根  $ q_1, q_2,…, q_k $  ，则
$$
h_n=c_1q_1^n+c_2q_2^n+…+c_kq_k^n\quad(3)
$$
是下述意义下  $ (1) $  的通解：任意给定初始值  $ h_0, h_1, …,h_{k-1} $  ， 都存在  $ c_1, c_2,…, c_k $  使得  $ (3) $  式是满足  $ (1) $  式和初始条件的**唯一**的数列。

##### 7.4.2(通解)

令  $ q_1,q_2,...,q_t $  为常系数线性齐次递推关系：
$$
h_n
=a_1h_{n-1}+a_2h_{n-2}+…+a_kh_{n-k}\quad(a_k≠0, n≥k) (1)
$$
的特征方程的**互异的根**。

如果  $ q_i $  是  $ (1) $  的特征方程的  $ s_i $  重根，那么该递推关系的通解中对应于  $ q_i $  的部分为：
$$
H_n^{(i)}=c_1q_i^n+c_2nq_i^n+...+c_{s_i}n^{s_i-1}q_i^n
$$
且该递推关系的通解为：
$$
h_n=H_n^{(1)}+H_n^{(2)}+...+H_n^{(t)}
$$

##### 7.4.3

令  $ h_0, h_1, h_2,…,h_n,… $  为满足  $ k $  阶常系数线性齐次递推关系：
$$
h_n+c_1h_{n-1}+…+c_kh_{n-k}=0 \quad(c_k≠0, n≥k) (1)
$$
的数列, 则它的生成函数  $ g(x) $  形如：
$$
g(x)=p(x)/q(x)\quad(2)
$$
其中，
  $ q(x) $  是具有非零常数项的  $ k $  次多项式， 
  $ p(x) $  是小于  $ k $  次的多项式。
反之, 给定这样的多项式  $ p(x) $  和  $ q(x) $  ， 则存在序列  $ h_0,h_1,…,h_n,… $ 满足  $ (1) $  式的  $ k $  阶常系数线性齐次递推关系, 其生成函数由  $ (2) $  式给出.

#### 方法

##### 特征方程法

详见定理7.4.1、7.4.2

###### 特征方程有重根

定理7.4.1不适用于特征方程有重根的情况

##### 生成函数法

（1）利用递推关系求出序列的生成函数： $ \frac{p(x)}{q(x)} $  ，其中，  $ p(x) $  是次数小于  $ k $  的多项式，而  $ q(x) $  是常数项等于 1 的  $ k $  阶多项式；
（2）用部分分式法，把  $ \frac{p(x)}{q(x)} $  表示为如下代数分式的和： $ \frac{c}{(1-rx)^t} $ 
（3）利用牛顿二项式展开  $ \frac{c}{(1-rx)^t} $  ，并把所有项求和，得到生成函数的幂级数。

+ 如何得到生成函数：

+ + 先设出生成函数的通项
  + 利用递推关系加减消除法到只剩初始项
    + 加减消除法的系数为递推关系的系数！！！
    + 最终是含  $ x $  项系数尽量为  $ 0 $ 
  
+ 牛顿二项式：

+ + 如果  $ n $  是正整数，而  $ r $  是非零实数，  $ |rx|<1 $  时，则有

  + 
    $$
    \begin{aligned}
    (1-rx)^{-n}&=\Sigma^\infty_{k=0}{-n\choose k}(-rx)^k\\
    &=\Sigma^\infty_{k=0}(-1)^k{-n\choose k}(rx)^k\\
    &=\Sigma^\infty_{k=0}{n+k-1\choose k}(rx)^k\\
    \end{aligned}
    $$

+ 

#### 联系

设特征方程为  $ r(x) $  ，生成函数  $ g(x)=\frac{p(x)}{q(x)} $ 

设相应特征方程  $ r(x)=0 $  ，其中  $ q(x)=x^kr(\frac{1}{x}) $ 

...

不想写了，详见PPT~~~

#### 小结

利用特征方程求解常系数线性齐次递推关系：

+ 写出相应的特征方程
+ 求解特征方程
+ + 如果没有重根，则直接给出通解（定理7.4.1）
  + 如果有重根，根据重根求出通解（定理7.4.2）
+ 将初始条件代入通解，得到满足初始条件的解

利用生成函数求解：使得  $ x^j (j ≥ k) $  前的系数为  $ 0 $ 

### 7.5 非齐次递推关系

#### 定义：

对于常系数线性递推关系
$$
h_n=a_1h_{n-1}+a_2h_{n-2}+...+a_kh_{n-k}+b_n\quad(a_k \neq 0,n\geq k)
$$

若  $ b_n \neq0 $ ，则称该递推关系为常系数线性非齐次递推关系。

#### 汉诺塔问题

##### 递推关系

$$
\begin{aligned}
h_n&=2h_{n-1}+1\quad(n\geq1)\\
h_0&=0\\
h_1&=1\\
h_2&=3
\end{aligned}
$$

##### 迭代求解

就嗯迭代

**但是迭代完了一定要数学归纳法证明结果的正确性**

#### 通解

##### 生成函数法

不一定可行，若  $ b_n $  为带  $ n $  的多项式则可能出问题。

##### 特征方程法

假设有非齐次递推关系
$$
h_n=a_1h_{n-1}+a_2h_{n-2}+...+a_kh_{n-k}+b_n\quad(1)
$$
若  $ f_n $ 是对应齐次递推关系
$$
h_n^{'}=h_n-b_n=a_1h_{n-1}+a_2h_{n-2}+...+a_kh_{n-k}\quad(2)
$$
的通解, 而  $ c_n $  是原非齐次递推关系（1）的一个特解,
那么：  $ h_n=cf_n+c_n $ 是原非齐次递推关系（1）的通解。

###### 小结

1. 求对应的齐次递推关系的通解；
2. 求该非齐次递推关系的一个特解；
3. 将一般解和特解结合得到该非齐次递推关系的
   通解；
4. 通过初始条件确定通解中出现的常系数值.

**难点：**

+ 特征方程求解
+ *找出一个特解*

尝试特解的方法：

根据非齐次项  $ b_n $  来尝试某些类型的特解（不绝对）：

+ 如果  $ b_n $  是  $ n $  的  $ k $  次多项式，尝试  $ h_n $  也是  $ n $  的  $ k $  次多项式
  + 若  $ b_n=d (常数) $ , 尝试  $ h_n=r (常数) $ 
  + 若  $ b_n=d_n+c (d, c是常数) $ , 尝试  $ h_n= rn+s (r,s是常数) $ 
  + 若  $ bn= an^2+dn+c (a,d,c是常数) $ , 尝试 $ hn
    = rn^2+sn+t (r, s,
    t是常数) $ 

+ 若  $ b_n=d^n (d是常数) $  是指数形式，尝试  $ h^n= pd^n (p是常数) $ 也是指数形式。

如：

若  $ h_n=p3^n $  不对，则可以尝试  $ h_n=pn3^n $ 

### 7.6 一个几何例子

#### 定义

##### 定义1

设有平面或空间中的点集  $ K $ , 若  $ K $  中任意两点
 $ p $  和  $ q $  的连线上的所有点都在  $ K $  内,称  $ K $  是凸集

#### 定理

##### 定理7.6.1

设  $ h_n $  表示用下面方法把凸多边形区域分成三角形区域的方法数：
在有  $ n+1 $  条边的凸多边形区域内通过插入不相交的对角线，而把它分成三角形区域。
定义  $ h_1=1 $ 。
则  $ h_n $  满足如下递推关系:
$$
h_n=h_1h_{n-1}+h_2h_{n-2}+...+h_{n-1}h_1=\Sigma^{n-1}_{k-1}h_kh_{n-k}(n\geq2)
$$
该递推关系解为：  $ h_n=\frac{1}{n}{{2n-2}\choose{n-1}}\quad(n=1,2,3...) $ 

其中：  $ \frac{1}{n}{{2n-2}\choose{n-1}} $  为 Catalan数  $ C_{n-1} $ 

## 第8章 特殊计数序列

### 8.1 Catalan 数

#### 定义

 Catalan 数列是序列  $ C_0, C_1,…, C_n,…, $  其中
$$
C_n = \frac{1}{n+1}{{2n}\choose{n}}，\quad n=0,1,2,...
$$
是第  $ n $ 个 Catalan 数。

凸  $ n+1 $  边形被在其内部不相交的对角线划分成三角形区域的方法数为  $ C_{n-1} $ 

由  $ C_{n-1}=h_n $  得递推为：
$$
C_n=C_0C_{n-1}+C_1C_{n-2}+...+C_{n-1}C_0
$$
另一个递推：
$$
C_n=\frac{4n-2}{n+1}C_{n-1}\quad(n\geq1),C_0=1
$$


#### 应用

1. 括号化问题
2. 出栈次序问题
3.   $ n $  个结点构成得二叉树数

#### 定理

##### 8.1.1

考虑由  $ n $  个  $ +1 $  和  $ n $  个  $ -1 $  构成的  $ 2n $  项序列
$$
a_1,a_2,...,a_{2n},
$$
其部分和总满足：
$$
a_1+a_2+...+a_k\geq0\quad (k=1,2,...,2n)
$$
的序列的个数等于第  $ n $  个Catalan数

可解决的问题

+ 买票找零问题
+ 走方格问题

#### 拟 Catalan 数

定义一个新数列：
$$
C_1^*,C_2^*,...,C_n^*,....
$$
其中， $ C_n^*=n!C_{n-1},n=1,2,...,n,... $ 

得到：
$$
C_n^*=(n-1)!{2n-2\choose n-1}
$$
将 Catalan 数的递推关系代入得到拟 Catalan 数的递推
关系：
$$
C_n^*=(4n-6)C_{n-1}^*\quad(n \geq 1)
$$
初值为：
$$
C_1^*=1
$$

### 8.2 差分序列

#### 定义

设  $ h_0, h_1, h_2, …, h_n, … $  是一个序列。定义新序列：
$$
\Delta h_0, \Delta h_1, \Delta h_2, …, \Delta h_n,…，
$$
称为  $ h_0, h_1, h_2, …, h_n, … $  的（一阶）差分序列，其中  $ \Delta h_n= h_{n+1}－h_n\quad(n≥0) $  ，是序列的相邻项的差。

##### 递归定义

 $ 0 $  阶差分序列： $ h_0, h_1, h_2, …, h_n, …, $ 

 $ 1 $  阶差分序列：  $ \Delta^1h_n＝h_{n+1}－h_n\quad(n＝0,1,2,…) $  

 $ 2 $  阶差分序列： 
$$
\begin{aligned} 
&\Delta^2h_n=\Delta(\Delta^1h_n)\\ 
=&\Delta^1h_{n+1}－\Delta^1h_n = (h_{n+2}－h_{n+1})－(h_{n+1}－h_n)\\
=&h_{n+2}－2h_{n+1}+ h_n\quad(n≥ 0)
\end{aligned}
$$
 $ k $  阶差分序列：
$$
\Delta^kh_n=\Delta(\Delta^{k-1}h_n)
=\Delta^{k-1}h_{n+1}－\Delta^{k-1}h_n
\quad (n=0,1,2,...)
$$

##### 差分表

设序列  $ h_n\quad(n=0,1,2,...) $  ，最上面一行是第  $ 0 $  行！！！
$$
h_0 \qquad h_1 \qquad h_2 \qquad h_3 \qquad h_4 \qquad ...\\
\Delta^1h_0 \quad \Delta^1h_1 \quad \Delta^1h_2 \quad \Delta^1h_3 \quad ...\\
\Delta^2h_0 \quad \Delta^2h_1 \quad \Delta^2h_2 \quad ...\\
\Delta^3h_0 \quad \Delta^3h_1 \quad ...\\
...
$$

+  $ \Delta^ph_n=\Delta^{p-1}h_{n+1}－\Delta^{p-1}h_n $ 
+ 序列  $ h_n (n＝0,1,2,…) $  的差分表由第  $ 0 $  行确定

#### 定理

##### 8.2.1

设序列的通项  $ h_n $  是  $ n $  的  $ p $  次多项式：
$$
h_n= a_pn^p+a_{p-1}n^{p-1}+a_{p-2}n^{p-2}+……+a_1n+a_0,
$$
则对于所有的  $ n\geq 0 $  ，必有：  $ ∆^{p+1}h_n= 0 $  。

##### 8.2.2

差分表的第  $ 0 $  条对角线等于
$$
c_0,c_1,c_2, …,c_p,0,0,0, …， 其中cp \neq 0
$$
的序列的通项满足：
$$
h_n=c_0{n\choose0}+c_1{n\choose1}+c_2{n\choose2}+...+c_p{n\choose p}
$$
的关于  $ n $  的  $ p $  次多项式。

###### 证明思路

线性性+简单差分表

##### 8.2.3

假设序列  $ h_0, h_1, …, h_n,… $  的差分表的第  $ 0 $  条对角线等于
$$
c_0, c_1, …, c_p, 0, 0,…
$$
那么：
$$
\Sigma^n_{k=0}h_k=c_0{n+1\choose1}+c_1{n+1\choose2}+...+c_p{n+1\choose p+1}
$$
（证明中间有一段： $ \Sigma^n_{k=0}{k\choose p}={n+1\choose p+1} $ ）

###### 应用

+ 一般项为多项式的序列的部分和

##### 8.2.4

若  $ 1\leq k\leq p-1 $  ，则：
$$
S(p,k)=kS(p-1,k)+S(p-1,k-1)
$$
类比二项式公式中：
$$
{n\choose k}={n-1\choose k}+{n-1\choose k-1}
$$
类  $ Pascal $  三角形：

直接上方的元素乘以  $ k $  再加上其左上方的元素

##### 8.2.5

第二类  $ Stirling $  数  $ S(p, k) $  计数的是把  $ p $  元素集合划分到  $ k $ 个不可区分的盒子且没有空盒子的划分的个数。

##### 8.2.6

对每一个满足  $ 0\leq k \leq p $  的整数  $ k $  ，都有
$$
S^{\sharp}(p,k)=\Sigma^k_{t=0}(-1)^t{k\choose t}(k-t)^p
$$
从而  $ S(p,k)=\frac 1{k!}\Sigma^k_{t=0}(-1)^t{k\choose t}(k-t)^p $  

##### 8.2.7

如果  $ p\geq1 $  ，则：
$$
B_p={p-1\choose0}B_0+
{p-1\choose1}B_1+
{p-1\choose2}B_2+
...
+{p-1\choose p-1}B_{p-1}
$$

##### 8.2.8

若  $ 1\leq k \leq p-1 $  ，则：
$$
s(p,k) = (p-1)s(p-1,k)+s(p-1,k-1)
$$

##### 8.2.9

第一类  $ Stirling $  数  $ S_1(p, k) $  是将  $ p $  个物品排成  $ k $  个非空的循环排列的方法数

#### 性质

+ 差分表由第  $ 0 $  行上元素的值就能决定
+ 差分表也可由第  $ 0 $  条对角线决定

#### 例子

##### 简单差分表1

若第  $ 0 $  条对角线全为  $ 0 $ 

##### 简单差分表1

第  $ 0 $  条对角线除一个  $ 1 $  外都是  $ 0 $ 

+   $ 1 $  在第  $ p $  行，前  $ p $  个元素就都为  $ 0 $  ，从  $ p+1 $  行开始的所有行的元素都是  $ 0 $ 

  $ h_p = 1 $  ，  $ h_0=0,h_1=0,...,h_{p-1}=0 $  ，故  $ h_n $  有因子  $ n(n-1)...(n-(p-1)) $  ，再代入  $ h_p = 1 $  ，得到：
$$
h_n=\frac{n(n-1)...(n-(p-1))}{p!}={n\choose p}
$$

#### 差分表的线性性

设  $ g_n $  和  $ f_n $  分别是两个序列的通项，若  $ h_n = g_n +f_n $ 

+ 一般的：  $ \Delta^ph_n=\Delta^pg_n+ \Delta^pf_n\quad,\quad p\geq 0  $ 
+ 更一般的，对于任何常数  $ c, d $  来说，
   $ \Delta^p(cg_n+df_n)= c\Delta^pg_n+d\Delta^pf_n\quad(p≥ 0, n≥ 0) $ 

#### 差分表的第0条

##### 组合意义

(由定理8.2.2)

对于序列  $ h_n= n^p $  ，设其差分表中第  $ 0 $  条对角线上的元素为   $ c_0, c_1, …, c_p, 0, 0,…， $  引入标记：
$$
c(p, 0) =c_0, c(p, 1) = c_1, …, c(p, p) =c_p, 0, 0, ... 
$$
则有：
$$
\begin{aligned}
h_n=n^p&=c_0{n\choose0}+c_1{n\choose1}+...+c_p{n\choose p}\\
&=c(p,0){n\choose0}+c(p,1){n\choose1}+...+c(p,p){n\choose p}
\end{aligned}
$$

###### 特殊值1：  $ c(p,0) $ 

$$
c(p,0)=
\begin{cases}
1& p=0\\
0& p \geq 1
\end{cases}
$$

###### 特殊值2：

由  $ n^p $  项系数相等，得：  $ 1=\frac{c(p,p)}{p!} $ 

  $ c(p,p)=p! $ 

###### 特殊值3：

$$
令 [n]_k=
\begin{cases}
n(n-1)...(n-k+1), &k\geq1\\
1, &k=0
\end{cases}
$$

则，  $ [n]_k $  =  $ n $  个不同元素中取  $ k $  个元素的排列数  $ P(n, k) $ 

递推关系：
$$
[n]_k=(n-k)[n]_k
$$
且：
$$
[n]_k=k!{n\choose k}
$$
故：
$$
\begin{aligned}
h_n=n^p&=c(p,0){\frac{[n]_0}{0!}}+c(p,1){\frac{[n]_1}{1!}}+...+c(p,p){\frac{[n]_p}{p!}}\\
&=\sum^p_{k=0}c(p,k){\frac{[n]_k}{k!}}\\
&=\sum^p_{k=0}\frac{c(p,k)}{k!}[n]_k
\end{aligned}
$$
令  $ S(p,k) = \frac{c(p,k)}{k!} $    $ (0\leq k\leq p) $  ，成为第二类  $ Srirling $  数

 $ h_n=n^p $  的展开式变为：  $ h_n=n^p=\sum^p_{k=0}S(p,k)[n]_k $ 

#### 第二类  $ Srirling $  数

##### 特殊值：

$$
S(p,0)=c(p,0)=
\begin{cases}
1& p=0\\
0& p \geq 1
\end{cases}
$$

$$
S(p,p)=1\quad(p\geq1)
$$

##### 递推公式：

定理8.2.4

##### 组合解释：

投球入盒

定理8.2.5

####  $ Bell $  数

令  $ S^{\sharp}(p,k) = k!S(p,k) $  表示把  $ \lbrace1, 2, …, p\rbrace $  分到  $ k $  个**非空**且**可区分**的
盒子的划分个数，则
$$
S^{\sharp}(p,k) = k!S(p,k)
$$
公式：定理 8.2.6

 $ S^{\sharp}(p,k) $ ：把  $ \lbrace1, 2, …, p\rbrace $  分到  $ k $  个**非空**且**可区分**的盒子的划分个数。

| $ p $  个物品 | $ k $  个盒子 | 空盒 |                     |
| :-----------: | :-----------: | :--: | :-----------------: |
|    有区别     |    无区别     | 没有 |     $ S(p,k) $      |
|    有区别     |    有区别     | 没有 | $ S^{\sharp}(p,k) $ |

##### 定义

  $ Bell $  数是将  $ p $  个元素的集合划分到非空、不可区分的盒子（盒子数  $ \leq p $ ）的划分数，记为  $ B_p $  ，则：
$$
B_p=S(p,0)+S(p,1)+...+S(p,p)
$$
是第二类  $ Stirling $  数三角形的一行的元素和

##### 递推

定理 8.2.7

#### 第一类  $ Srirling $  数

##### 对比

第二类  $ Srirling $  数  $ S(n,p) $ 

+ 指出如何用  $ [n]_0,[n]_1,[n]_2,...,[n]_p $  写出  $ n^p $ 
+ 把  $ p $  个元素的集合划分到  $ k $  个不可区分的盒子且没有空盒的划分的个数

第一类  $ Srirling $  数  $ s(n,p) $ 

+ 如何用  $ n^0,n^1,n^2,...,n^p $  写出  $ [n]_p $ 
+ 将  $ p $  个物品排成  $ k $  个非空的循环排列方法数

##### 定义

一般地，  $ [n]_p $  展开式有  $ p $  个因子
乘开后得到  $ n $  的幂多项式，  $ n^p,n^{p-1},...,n^1,n^0 $  
其系数的符号正负相间。故：
$$
[n]_p=a^p_nn^p
-a^{p-1}_nn^{p-1}
+......+
+(-1)^{p-1}a^{1}_nn^{1}+
(-1)^{p}a^{0}_nn^{0}
$$
 $ n_k $  前的系数  $ a_n^k $  称为第一类  $ Stirling $  数，记为  $ s(p, k) $ 

##### 特殊值

$$
s(p, 0) = 0 \quad(p\geq1)\\s(p, p) =1 \quad(p\geq0)
$$

##### 递推式

定理 8.2.8

##### 组合意义

定理 8.2.9

#### 小结

| $ p $  个球 |    $ k $  个盒    | 是否为空 |               方案个数               |                     |
| :---------: | :---------------: | :------: | :----------------------------------: | :-----------------: |
|   有区别    |      有区别       |  有空盒  |               $ k^p $                |                     |
|   有区别    |      无区别       |  无空盒  |              $ S(p,k) $              |    $ S_2(p,k) $     |
|   有区别    |      有区别       |  无空盒  |             $ k!S(p,k) $             | $ S^{\sharp}(p,k) $ |
|   有区别    |      无区别       |  有空盒  | $ S(p,1)+S(p,2)+...S(p,k)，p\geq k $ |    $ Bell $  数     |
|   有区别    |      无区别       |  有空盒  | $ S(p,1)+S(p,2)+...S(p,p)，p\leq k $ |    $ Bell $  数     |
|   有区别    | $ k $  个循环序列 |   非空   |              $ s(p,k) $              |    $ S_1(p,k) $     |